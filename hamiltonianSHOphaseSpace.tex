%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{hamiltonianSHOphaseSpace}
%\renewcommand{\dirname}{notes/phy452/}
%\newcommand{\keywords}{Statistical mechanics, PHY452H1S, Hamiltonian, phase space}
%
%\newcommand{\nbref}[1]{notes/phy452/mathematica/#1}
%\input{../peeter_prologue_print2.tex}
%
%\beginArtNoToc
%
%\generatetitle{1D SHO phase space}
\label{chap:hamiltonianSHOphaseSpace}

Let's review the 1D SHO to get a better feel for the ideas of phase space.  Given a spring and mass system
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:20}
F = - k x = -(\spacegrad \phi)_x,
\end{equation}
our potential is
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:40}
\phi = \inv{2} k x^2,
\end{equation}

So, our Hamiltonian is
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:60}
H = \inv{2m}{p^2} + \inv{2} k x^2.
\end{equation}

Hamilton's equations follow from \(H = p \xdot - \LL\)
\begin{subequations}
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:80}
\PD{p}{H} = \xdot
\end{equation}
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:100}
\PD{x}{H} = -\pdot.
\end{equation}
\end{subequations}

For the SHO this is
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:120}
\ddt{}
\begin{bmatrix}
p \\
x
\end{bmatrix}
=
\begin{bmatrix}
-\PD{x}{H} \\
\PD{p}{H}
\end{bmatrix}
=
\begin{bmatrix}
- k x \\
p/m
\end{bmatrix}.
\end{equation}

It's convenient to non-dimensionalize this.  Using \(\omega = \sqrt{k/m}\), which has dimensions of \(1/T\), we form
\begin{dmath}\label{eqn:hamiltonianSHOphaseSpace:140}
\ddt{}
\begin{bmatrix}
p/m \\
\omega x
\end{bmatrix}
=
\begin{bmatrix}
- (k/m) x \\
(\omega) p/m
\end{bmatrix}
=
\omega
\begin{bmatrix}
- \omega x \\
p/m
\end{bmatrix}
=
\omega
\begin{bmatrix}
0 & -1 \\
1 & 0
\end{bmatrix}
\begin{bmatrix}
p/m \\
\omega x
\end{bmatrix}
\end{dmath}

With definitions
\begin{subequations}
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:160}
i =
\begin{bmatrix}
0 & -1 \\
1 & 0
\end{bmatrix}
\end{equation}
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:180}
\Bx =
\begin{bmatrix}
p/m \\
\omega x
\end{bmatrix},
\end{equation}
\end{subequations}
the SHO Hamilton's equations are just
\boxedEquation{eqn:hamiltonianSHOphaseSpace:200}{
\Bx' = i \omega \Bx.
}

The solution follows immediately
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:220}
\Bx = e^{i \omega t} \Bx_0.
\end{equation}

We expect matrix exponential to have the structure of a rotation matrix, so let's write it out explicitly to see its structure
\begin{dmath}\label{eqn:hamiltonianSHOphaseSpace:240}
e^{i \omega t}
=
I \cos(\omega t)
+ i \sin(\omega t)
=
\begin{bmatrix}
1 & 0 \\
0 & 1
\end{bmatrix}
\cos(\omega t)
+
\begin{bmatrix}
0 & -1 \\
1 & 0
\end{bmatrix}
\sin(\omega t)
=
\begin{bmatrix}
\cos(\omega t) & - \sin(\omega t) \\
\sin(\omega t) & \cos(\omega t)
\end{bmatrix}.
\end{dmath}

In this non-dimensionalized phase space, with \(p/m\) on the horizontal axis and \(\omega x\) on the vertical axis, this is a counterclockwise rotation.  The (squared) radius of the rotation is
\begin{dmath}\label{eqn:hamiltonianSHOphaseSpace:300}
\begin{aligned}
(p_0/m)^2
+
(\omega x_0)^2
&=
\frac{2}{m}
\lr{
   \frac{p_0^2}{m}
   + \inv{2} \omega^2 m x_0^2
} \\
&=
\frac{2}{m}
\lr{
   \frac{p_0^2}{2m}
   + \inv{2} k x_0^2
} \\
&=
\frac{2 E}{m}.
\end{aligned}
\end{dmath}

% dim check: [E/m] = [v^2]
It makes sense to put the initial position in phase space in polar form too.  We can write
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:320}
\begin{bmatrix}
p_0/m \\
\omega x_0
\end{bmatrix}
=
\sqrt{\frac{2 E}{m}}
e^{i \theta}
\begin{bmatrix}
1 \\
0
\end{bmatrix},
\end{equation}
where
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:340}
\theta = \Atan \lr{ \omega m \frac{x_0}{p_0} }.
\end{equation}

Now the non-dimensionalized phase space solution takes the particularly simple form
\boxedEquation{eqn:hamiltonianSHOphaseSpace:360}{
\Bx = \sqrt{ \frac{2 E}{m} } e^{i (\omega t + \theta)}
\begin{bmatrix}
1 \\
0
\end{bmatrix}.
}

\paragraph{Removing the non-dimensionalization}

Written explicitly, our momentum and position trace out, elliptical trajectories
\begin{subequations}
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:260}
p = p_0 \cos(\omega t) - \omega m x_0 \sin(\omega t)
\end{equation}
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:280}
x = \frac{p_0}{m \omega} \sin(\omega t) + x_0 \cos(\omega t).
\end{equation}
\end{subequations}

With the initial phase space point specified as a rotation from the momentum axis as in \eqnref{eqn:hamiltonianSHOphaseSpace:340}, this is just
\begin{subequations}
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:260b}
p
= \sqrt{ \frac{2 E}{m} } m \cos(\omega t + \theta)
= \sqrt{ 2 m E } \cos(\omega t + \theta)
\end{equation}
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:280b}
x = \sqrt{ \frac{2 E}{m} } \inv{\omega} \sin(\omega t + \theta)
= \sqrt{ \frac{2 E}{k} } \sin(\omega t + \theta).
\end{equation}
\end{subequations}

In \cref{fig:shoPhaseSpacePlots:shoPhaseSpacePlotsFig1} are trajectory plots for two different initial time pairs of phase space points \((p_0, x_0)\), and \((p_1, x_1)\).  Roughly between these points a circular region of this phase space is plotted, with the same region plotted at a couple of other points in time.  This shows the trajectory of a region of phase space.  Observe that the area appears to visually be invariant, as we expect from Liouville's theorem.  See \nbref{shoPhaseSpacePlots.nb} for an interactive way to play with this.

\imageFigure{../figures/phy452-basicstatmech/shoPhaseSpacePlotsFig1}{A SHO phase space trajectory.}{fig:shoPhaseSpacePlots:shoPhaseSpacePlotsFig1}{0.2}

Observe that the rotation angle \(\theta\) doesn't specify a geometric rotation of the ellipse.  Instead, it is a function of the starting point of the elliptical trajectory through phase space.

\paragraph{Aside.  Complex representation of phase space points}

It's interesting to note that we can also work in a complex representation of phase space, instead of a matrix picture (for this 1D SHO problem).
\begin{dmath}\label{eqn:hamiltonianSHOphaseSpace:380}
\ddt{} \lr{
\frac{p}{m} + i \omega x
}
=
\omega
\lr{
- \omega x + i \frac{p}{m}
}
=
i \omega
\lr{
\frac{p}{m} + i \omega x
}.
\end{dmath}

Writing
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:400}
z = \frac{p}{m} + i \omega x,
\end{equation}

Hamilton's equations take the form
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:420}
z' = i \omega z.
\end{equation}

Again, we can read off the solution by inspection
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:440}
z = e^{i \omega t} z_0.
\end{equation}

\paragraph{The continuity equation}
\index{continuity equation}

Thinking back to the origin of the 3D continuity equation from fluid mechanics, we used the geometrical argument that any change to the mass in a volume had to leave through the boundary.  This was
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:460}
\PD{t}{} \int_V \rho dV
= -\int_{\partial V} \lr{ \rho \Bu } \cdot \ncap dA
= -\int_{V} \spacegrad \cdot \lr{ \rho \Bu } dV.
\end{equation}

We used Green's theorem above, allowing us to write, provided the volume is fixed
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:480}
0 =
\int_V
\lr{
\PD{t}{\rho}
+
\spacegrad \cdot \lr{ \rho \Bu }
}
dV,
\end{equation}

or
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:500}
0 =
\PD{t}{\rho}
+
\spacegrad \cdot \lr{ \rho \Bu }.
\end{equation}

Consider the following phase space picture \cref{fig:densityCurrentThroughPhaseSpaceArea:densityCurrentThroughPhaseSpaceAreaFig2}.  The time evolution of any individual particle (or set of particles that lie in the same element of phase space) is directed in the direction \((\xdot, \pdot)\).  So, the phase space density leaving through the surface is in proportion to the normal component of \(\Bj = \rho (\dot{q}, \dot{p})\) (red in the figure).

\imageFigure{../figures/phy452-basicstatmech/densityCurrentThroughPhaseSpaceAreaFig2}{Phase space current.}{fig:densityCurrentThroughPhaseSpaceArea:densityCurrentThroughPhaseSpaceAreaFig2}{0.2}

With this geometrical picture in mind, the \(6N\) dimensional phase space equivalent of \eqnref{eqn:hamiltonianSHOphaseSpace:460}, and a basis \(\Be_{i_{\alpha}}\) for the positions \(q_{i_\alpha}\) and \(\Bf_{i_\alpha}\) for the momentum components \(p_{i_\alpha}\) is then
\begin{dmath}\label{eqn:hamiltonianSHOphaseSpace:520}
\PD{t}{} \int_{V_{6N}} \rho d^{3N} q d^{3N} p
= -\int_{\partial V_{6N}} \lr{ \rho
\sum_{i_\alpha} \lr{
\Be_{i_\alpha} \dot{q}_{i_\alpha}
+\Bf_{i_\alpha} \dot{p}_{i_\alpha}
}
} \cdot \ncap dA
= -\int_{V_{6N}} d^{3N} q d^{3N} p
\sum_{i_\alpha}
\lr{
\PD{q_{i_\alpha}}{\lr{\rho \dot{q}_{i_\alpha}}}
+\PD{p_{i_\alpha}}{\lr{\rho \dot{p}_{i_\alpha}}}
}.
\end{dmath}

Here \(dA\) is the surface area element for the phase space and \(\ncap\) is the unit normal to this surface.  We have to assume the existence of a divergence theorem for the \(6N\) dimensional space.

We can now regroup, and find for the integrand
\begin{equation}\label{eqn:hamiltonianSHOphaseSpace:540}
0 =
\PD{t}{\rho}
+
\sum_{i_\alpha}
\lr{
\PD{q_{i_\alpha}}{\lr{\rho \dot{q}_{i_\alpha}}}
+\PD{p_{i_\alpha}}{\lr{\rho \dot{p}_{i_\alpha}}}
},
\end{equation}

which is the \underlineAndIndex{continuity equation}.  The assumptions that we have to make are that the flow of the density in phase space through the surface is proportional to the projection of the vector \(\rho (\dot{q}_{i_\alpha}, \dot{p}_{i_\alpha})\), and then use the same old arguments (extended to a \(6N\) dimensional space) as we did for the continuity equation for 3D masses.

%\EndNoBibArticle
