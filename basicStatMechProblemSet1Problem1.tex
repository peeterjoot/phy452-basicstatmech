%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeoproblem{Limit of binomial distribution}{basicStatMech:problemSet1:1}{2013 ps1, p1}{
Starting from the simple case of the binomial distribution
\begin{equation}\label{eqn:basicStatMechProblemSet1Problem1:20}
P_N(X) = 2^{-N} \frac{N!}{
\left(
\frac{N + X}{2}
\right)!
\left(
\frac{N - X}{2}
\right)!
},
\end{equation}
derive the Gaussian distribution which results when \(N \gg 1\) and \(\Abs{X} \ll N\).
} % makeoproblem
\makeanswer{basicStatMech:problemSet1:1}{
We'll work with the logarithms of \(P_N(X)\).
%
Note that the logarithm of the Stirling approximation takes the form
\begin{equation}\label{eqn:basicStatMechProblemSet1Problem1:40}
\begin{aligned}
\ln a!
&\approx \ln \sqrt{2\pi} + \inv{2} \ln a + a \ln a - a \\
&=
\ln \sqrt{2\pi} + \left( a + \inv{2} \right) \ln a - a.
\end{aligned}
\end{equation}
%
Using this we have
\begin{equation}\label{eqn:basicStatMechProblemSet1Problem1:60}
\ln
\left(
(N + X)/2
\right)!
%=
%\ln \sqrt{2 \pi}
%+
%\left(
%\frac{N + X}{2} + \inv{2}
%\right)
%\left(
%\ln (N + X) - \ln 2
%\right)
%- \frac{N + X}{2}
=
\ln \sqrt{2 \pi}
+
\left(
\frac{N + 1 + X}{2}
\right)
\left(
\ln
\left(
1 + \frac{X}{N}
\right)
+ \ln \frac{N}{2}
\right)
- \frac{N + X}{2}.
\end{equation}
%
Adding \(\ln \left( (N + X)/2 \right)! + \ln \left( (N - X)/2 \right)!\), we have
\begin{equation}\label{eqn:basicStatMechProblemSet1Problem1:80}
\begin{aligned}
&2 \ln \sqrt{2 \pi}
-N 
+
   \left(
   \frac{N + 1 + X}{2}
   \right) \times \\
&\quad
   \left(
   \ln
   \left(
   1 + \frac{X}{N}
   \right)
   + \ln \frac{N}{2}
   \right)
+
   \left(
   \frac{N + 1 - X}{2}
   \right)
   \left(
   \ln
   \left(
   1 - \frac{X}{N}
   \right)
   + \ln \frac{N}{2}
   \right) \\
&=
2 \ln \sqrt{2 \pi}
-N 
+
\left(
\frac{N + 1}{2}
\right) \times \\
&\left(
\ln
\left(
1 - \frac{X^2}{N^2}
\right)
+ 2 \ln \frac{N}{2}
\right)
+
\frac{X}{2}
\left(
	\ln
	\left(
	1 + \frac{X}{N}
	\right)
-
	\ln
	\left(
	1 - \frac{X}{N}
	\right)
\right)
\end{aligned}
\end{equation}
%
Recall that we can expand the log around \(1\) with the slowly converging Taylor series
\begin{subequations}
\begin{equation}\label{eqn:basicStatMechProblemSet1Problem1:100}
\ln( 1 + x) = x - \frac{x^2}{2} + \frac{x^3}{3} - \frac{x^4}{4}
\end{equation}
\begin{equation}\label{eqn:basicStatMechProblemSet1Problem1:120}
\ln( 1 - x) = -x - \frac{x^2}{2} - \frac{x^3}{3} - \frac{x^4}{4},
\end{equation}
\end{subequations}
but if \(x \ll 1\) the first order term will dominate, so in this case where we assume \(X \ll N\), we can approximate this sum of factorial logs to first order as
\begin{equation}\label{eqn:basicStatMechProblemSet1Problem1:140}
2 \ln \sqrt{2 \pi} -N
+
\left(
\frac{N + 1}{2}
\right)
\left(
- \frac{X^2}{N^2}
+ 2 \ln \frac{N}{2}
\right)
+
\frac{X}{2}
\left(
	\frac{X}{N} + \frac{X}{N}
\right)
=
2 \ln \sqrt{2 \pi} -N
+ \frac{X^2}{N} \left(
- \frac{N + 1}{2N} + 1
\right)
+ (N + 1) \ln \frac{N}{2}
\approx
2 \ln \sqrt{2 \pi} -N
+ \frac{X^2}{2 N}
+ (N + 1) \ln \frac{N}{2}.
\end{equation}
%
Putting the bits together, we have
\begin{equation}\label{eqn:basicStatMechProblemSet1Problem1:160}
\begin{aligned}
\ln P_N(X) 
&\approx - N \ln 2 +
\left( N + \inv{2}
\right) \ln N - \cancel{N} - \ln \sqrt{2 \pi} + \cancel{N}
-\frac{X^2}{2N} - (N + 1) \ln \frac{N}{2} \\
=
\left(
-\cancel{N} + (\cancel{N} + 1) \ln 2
\right)
+
\left(
\cancel{N} + \inv{2} - \cancel{N} - 1
\right) \ln N
- \ln \sqrt{2 \pi} - \frac{X^2}{2N} \\
&=
\ln
\left(
\frac{2}{\sqrt{2 \pi N}}
\right)
-\frac{X^2}{2 N}.
\end{aligned}
\end{equation}
%
Exponentiating gives us the desired result
\boxedEquation{eqn:basicStatMechProblemSet1Problem1:180}{
P_N(X) \rightarrow \frac{2}{\sqrt{2 \pi N}} e^{-\frac{X^2}{2 N}}.
}
}
