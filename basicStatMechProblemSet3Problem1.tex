%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeoproblem{Surface area of a sphere in d-dimensions}{basicStatMech:problemSet3:1}{2013 problem set III, p1}{
Consider a \(d\)-dimensional sphere with radius \(R\). Derive the volume of the sphere \(V_d(R)\) and its surface area \(S_d(R)\) using \(S_d(R) = dV_d(R)/dR\).
} % makeoproblem

\makeanswer{basicStatMech:problemSet3:1}{

Let's start with some terminology and notation, borrowing from \citep{wiki:nsphere}

\begin{itemize}
\item \(1\)-sphere : 2D circle, with ``volume'' \(V_2\)
\item \(2\)-sphere : 3D sphere, with volume \(V_3\)
\item \(3\)-sphere : 4D Euclidean hypersphere, with ``volume'' \(V_4\)
\item \(4\)-sphere : 5D Euclidean hypersphere, with ``volume'' \(V_5\)
\item \(\cdots\)
\end{itemize}

To calculate the volume, we require a parameterization allowing for expression of the volume element in an easy to integrate fashion.  For the \(1\)-sphere, we can use the usual circular and spherical coordinate volume elements
\begin{subequations}
\begin{dmath}\label{eqn:basicStatMechProblemSet3Problem1:20}
V_2(R) = 4 \int_0^R r dr \int_0^{\pi/2} d\theta = 4 \frac{R^2}{2} \frac{\pi}{2} = \pi R^2
\end{dmath}
\begin{dmath}\label{eqn:basicStatMechProblemSet3Problem1:40}
V_3(R) = 8 \int_0^R r^2 dr \int_0^{\pi/2} \sin\theta d\theta \int_0^{\pi/2} d\phi
= 8 \frac{R^3}{3} (1) \frac{\pi}{2}
= \frac{4}{3} \pi R^3
\end{dmath}
\end{subequations}

Here, to simplify the integration ranges, we've calculated the ``volume'' integral for just one quadrant or octet of the circle and sphere respectively, as in \cref{fig:basicStatMechProblemSet3:basicStatMechProblemSet3Fig1}.

\imageFigure{../figures/phy452-basicstatmech/basicStatMechProblemSet3Fig1}{Integrating over just one quadrant of circle or octet of sphere}{fig:basicStatMechProblemSet3:basicStatMechProblemSet3Fig1}{0.3}

How will we generalize this to higher dimensions?  To calculate the volume elements in a systematic fashion, we can introduce a parameterization and use a Jacobian to change from Cartesian coordinates.  For the \(1\)-volume and \(2\)-volume cases those parameterizations were the familiar
\begin{subequations}
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:60}
\begin{aligned}
x_1 &= r \cos\theta \\
x_0 &= r \sin\theta
\end{aligned}
\end{equation}
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:80}
\begin{aligned}
x_2 &= r \cos\theta \\
x_1 &= r \sin\theta \cos\phi \\
x_0 &= r \sin\theta \sin\phi
\end{aligned}
\end{equation}
\end{subequations}

Some reflection shows that this generalizes nicely.  Let's use shorthand
\begin{subequations}
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:100}
C_k = \cos\theta_k
\end{equation}
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:120}
S_k = \sin\theta_k,
\end{equation}
\end{subequations}
and pick \(V_5\), say, a dimension bigger than the 2D or 3D cases that we can do by inspection, we can parameterize with
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:140}
\begin{aligned}
x_4 &= r C_4 \\
x_3 &= r S_4 C_3 \\
x_2 &= r S_4 S_3 C_2 \\
x_1 &= r S_4 S_3 S_2 C_1 \\
x_0 &= r S_4 S_3 S_2 S_1.
\end{aligned}
\end{equation}

Our volume element
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:160}
dV_5 =
\mathLabelBox
[
   labelstyle={xshift=2cm},
   linestyle={out=270,in=90, latex-}
]
{
\frac{\partial(x_4, x_3, x_2, x_1, x_0)}{\partial(r, \theta_4, \theta_3, \theta_2, \theta_1)}
}{\(\equiv J_5\)
}
dr d\theta_4 d\theta_3 d\theta_2 d\theta_1
\end{equation}

That Jacobian is
\begin{dmath}\label{eqn:basicStatMechProblemSet3Problem1:180}
J_5 =
\left\lvert
\begin{array}{lllll}
C_4               &          -  r S_4               & \phantom{-} 0                  & \phantom{-} 0                 & \phantom{-} 0                  \\
S_4 C_3           & \phantom{-} r C_4 C_3           &          -  r S_4 S_3          & \phantom{-} 0                 & \phantom{-} 0                  \\
S_4 S_3 C_2       & \phantom{-} r C_4 S_3 C_2       & \phantom{-} r S_4 C_3 C_2      &          -  r S_4 S_3 S_2     & \phantom{-} 0                  \\
S_4 S_3 S_2 C_1   & \phantom{-} r C_4 S_3 S_2 C_1   & \phantom{-} r S_4 C_3 S_2 C_1  & \phantom{-} r S_4 S_3 C_2 C_1 &          -  r S_4 S_3 S_2 S_1  \\
S_4 S_3 S_2 S_1   & \phantom{-} r C_4 S_3 S_2 S_1   & \phantom{-} r S_4 C_3 S_2 S_1  & \phantom{-} r S_4 S_3 C_2 S_1 & \phantom{-} r S_4 S_3 S_2 C_1
\end{array}
\right\rvert
=
r^4 S_4^3 S_3^2 S_2^1 S_1^0
%\begin{vmatrix}
%C_4               & -S_4               &   0            &  0       &  0   \\
%S_4 C_3           &  C_4 C_3           & - S_3          &  0       &  0   \\
%S_4 S_3 C_2       &  C_4 S_3 C_2       &   C_3 C_2      & -S_2     &  0   \\
%S_4 S_3 S_2 C_1   &  C_4 S_3 S_2 C_1   &   C_3 S_2 C_1  &  C_2 C_1 & -S_1 \\
%S_4 S_3 S_2 S_1   &  C_4 S_3 S_2 S_1   &   C_3 S_2 S_1  &  C_2 S_1 &  C_1
%\end{vmatrix}
\left\lvert
\begin{array}{lllll}
% row 1
      \begin{array}{l}
      C_4
      \end{array}
      \begin{array}{l}
      \phantom{S_3 S_2 S_1}
      \end{array}
   &
      \begin{array}{l}
      -S_4
      \end{array}
      \begin{array}{l}
      \phantom{S_3 S_2 S_1}
      \end{array}
   &
      \begin{array}{l}
      \phantom{-}0
      \end{array}
   &
      \begin{array}{l}
      \phantom{-}0
      \end{array}
   &
      \begin{array}{l}
      \phantom{-}0
      \end{array}
\\
% row 2-5:
\begin{array}{l}
S_4 \\
S_4 \\
S_4 \\
S_4
\end{array}
\myBoxed{
\begin{array}{l}
 C_3            \\
 S_3 C_2        \\
 S_3 S_2 C_1    \\
 S_3 S_2 S_1
\end{array}
}
&
\begin{array}{l}
\phantom{-}C_4 \\
\phantom{-}C_4 \\
\phantom{-}C_4 \\
\phantom{-}C_4
\end{array}
\myBoxed{
\begin{array}{l}
C_3           \\
S_3 C_2       \\
S_3 S_2 C_1   \\
S_3 S_2 S_1
\end{array}
}
&
\begin{array}{l}
         -  S_3           \\
\phantom{-} C_3 C_2       \\
\phantom{-} C_3 S_2 C_1   \\
\phantom{-} C_3 S_2 S_1
\end{array}
&
\begin{array}{l}
\phantom{-} 0        \\
         -  S_2      \\
\phantom{-} C_2 C_1  \\
\phantom{-} C_2 S_1
\end{array}
&
\begin{array}{l}
\phantom{-}0   \\
\phantom{-}0   \\
         - S_1 \\
\phantom{-}C_1
\end{array}
\end{array}
\right\rvert
\end{dmath}

Observe above that the cofactors of both the \(1,1\) and the \(1,2\) elements, when expanded along the first row, have a common factor.  This allows us to work recursively
\begin{dmath}\label{eqn:basicStatMechProblemSet3Problem1:200}
J_5
= r^4 S_4^3 S_3^2 S_2^1 S_1^0
(C_4^2 - - S_4^2)
\left\lvert
\begin{array}{llll}
C_3           &          -  S_3          & \phantom{-} 0       & \phantom{-} 0    \\
S_3 C_2       & \phantom{-} C_3 C_2      &          -  S_2     & \phantom{-} 0    \\
S_3 S_2 C_1   & \phantom{-} C_3 S_2 C_1  & \phantom{-} C_2 C_1 &          -  S_1  \\
S_3 S_2 S_1   & \phantom{-} C_3 S_2 S_1  & \phantom{-} C_2 S_1 & \phantom{-} C_1
\end{array}
\right\rvert
=
r S_4^3 J_4
\end{dmath}

Similarly for the 4D volume
\begin{dmath}\label{eqn:basicStatMechProblemSet3Problem1:220}
J_4
= r^3 S_3^2 S_2^1 S_1^0
\left\lvert
\begin{array}{llll}
C_3           &          -  S_3          & \phantom{-} 0       & \phantom{-} 0    \\
S_3 C_2       & \phantom{-} C_3 C_2      &          -  S_2     & \phantom{-} 0    \\
S_3 S_2 C_1   & \phantom{-} C_3 S_2 C_1  & \phantom{-} C_2 C_1 &          -  S_1  \\
S_3 S_2 S_1   & \phantom{-} C_3 S_2 S_1  & \phantom{-} C_2 S_1 & \phantom{-} C_1
\end{array}
\right\rvert
= r^3 S_3^2 S_2^1 S_1^0 (C_2^2 + S_2^2)
\left\lvert
\begin{array}{lll}
\phantom{-} C_2      &          -  S_2     & \phantom{-} 0    \\
\phantom{-} S_2 C_1  & \phantom{-} C_2 C_1 &          -  S_1  \\
\phantom{-} S_2 S_1  & \phantom{-} C_2 S_1 & \phantom{-} C_1
\end{array}
\right\rvert
= r S_3^2 J_3
\end{dmath}

and for the 3D volume
\begin{dmath}\label{eqn:basicStatMechProblemSet3Problem1:240}
J_3
= r^2 S_2^1 S_1^0
\left\lvert
\begin{array}{lll}
\phantom{-} C_2      &          -  S_2     & \phantom{-} 0    \\
\phantom{-} S_2 C_1  & \phantom{-} C_2 C_1 &          -  S_1  \\
\phantom{-} S_2 S_1  & \phantom{-} C_2 S_1 & \phantom{-} C_1
\end{array}
\right\rvert
= r^2 S_2^1 S_1^0 (C_2^2 + S_2^2)
\left\lvert
\begin{array}{ll}
C_1 &          -  S_1  \\
S_1 & \phantom{-} C_1
\end{array}
\right\rvert
= r S_2^1 J_2,
\end{dmath}
and finally for the 2D volume
\begin{dmath}\label{eqn:basicStatMechProblemSet3Problem1:260}
J_2
= r S_1^0
\left\lvert
\begin{array}{ll}
C_1 &          -  S_1  \\
S_1 & \phantom{-} C_1
\end{array}
\right\rvert
= r S_1^0.
\end{dmath}

Putting all the bits together, the ``volume'' element in the n-D space is
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:280}
dV_n = dr d\theta_{n-1} \cdots d\theta_{1} r^{n-1} \prod_{k=0}^{n-2} (\sin\theta_{k+1})^{k},
\end{equation}
and the total volume is
\begin{dmath}\label{eqn:basicStatMechProblemSet3Problem1:300}
V_n(R)
= 2^n
\int_0^R r^{n-1} dr
\prod_{k=0}^{n-2} \int_0^{\pi/2} d\theta \sin^k \theta
= 2^n \frac{R^{n}}{n}
\prod_{k=0}^{n-2} \int_0^{\pi/2} d\theta \sin^k \theta
=
\frac{4 R^2}{n} (n-2) 2^{n-2} \frac{R^{n-2}}{n-2}
\prod_{k=n-3}^{n-2} \int_0^{\pi/2} d\theta \sin^k \theta
\prod_{k=0}^{n-4} \int_0^{\pi/2} d\theta \sin^k \theta
=
4 R^2 \frac{n-2}{n}
V_{n-2}(R)
\int_0^{\pi/2} d\theta \sin^{n-2} \theta
\int_0^{\pi/2} d\theta \sin^{n-3} \theta
=
4 R^2 \frac{n-2}{n}
V_{n-2}(R)
\frac{\pi}{2 (n-2)}.
\end{dmath}

Note that a single of these sine power integrals has a messy result (see: \nbref{statMechProblemSet3.nb})
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:320}
\int_0^{\pi/2} d\theta \sin^{k} \theta
=
\frac{\sqrt{\pi } \Gamma \left(\frac{k+1}{2}\right)}{2 \Gamma \left(\frac{k}{2}+1\right)},
\end{equation}
but the product is simple, and that result, computed in \nbref{statMechProblemSet3.nb}, is inserted above, providing an expression for the n-D volume element as a recurrence relation
\boxedEquation{eqn:basicStatMechProblemSet3Problem1:340}{
V_{n} = \frac{2 \pi}{n} R^2 V_{n-2}(R).
}

With this recurrence relation we can find the volume \(V_{2n}\) or \(V_{2n+1}\) in terms of \(V_2\) and \(V_3\) respectively.  For the even powers we have
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:360}
\begin{array}{lll}
V_{2(2)}
&= \frac{2 \pi R^2}{4} V_{2}
&= \frac{2^1 \pi R^2}{2(2)} V_{2}  \\
V_{2(3)}
&= \frac{(2 \pi R^2)^2}{(6)(4)} V_{2}
&= \frac{2^2 (\pi R^2)^2}{2^2 (3)(2)} V_{2}  \\
V_{2(4)}
&= \frac{(2 \pi R^2)^3}{(8)(6)(4)} V_{2}
&= \frac{2^3 (\pi R^2)^3}{2^3 (4)(3)(2)} V_{2}
\end{array}
\end{equation}

\begin{dmath}\label{eqn:basicStatMechProblemSet3Problem1:380}
V_{2(n)}
= \frac{2^n (\pi R^2)^{n-1}}{(2n)!!} V_{2}
= \frac{(\pi R^2)^{n-1}}{(n)!} V_{2}
= \frac{(\pi R^2)^{n-1}}{(n)!} \pi R^2
\end{dmath}

This gives us a closed form expression for the even powers for \(n \ge 2\)

\boxedEquation{eqn:basicStatMechProblemSet3Problem1:400}{
V_{2(n)} = \frac{(\pi R^2)^{n}}{n!}.
}

Observe that this also conveniently gives \(V_2 = \pi R^2\), so is actually valid for \(n \ge 1\).  Now for the odd powers
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:420}
\begin{array}{lll}
V_{2(2)+1}
&= \frac{2 \pi R^2}{5} V_{3}
&= 3 \frac{2^1 \pi R^2}{5!!} V_{3}  \\
V_{2(3)+1}
&= 3 \frac{(2 \pi R^2)^2}{7 5 3} V_{3}
&= 3 \frac{2^2 (\pi R^2)^2}{7!!} V_{2}  \\
V_{2(4)+1}
&= 3 \frac{(2 \pi R^2)^3}{(9)(7)(5)(3)} V_{2}
&= 3 \frac{2^3 (\pi R^2)^3}{9!!} V_{2}
\end{array}
\end{equation}

\begin{dmath}\label{eqn:basicStatMechProblemSet3Problem1:440}
V_{2(n)+1}
= 3 \frac{2^{n-1} (\pi R^2)^{n-1}}{(2n +1)!!} V_{2}
= 3 \frac{2^{n-1} (\pi R^2)^{n-1}}{(2n +1)!!} \frac{4}{3} \pi R^3
\end{dmath}

So, for \(n \ge 2\) we have

\boxedEquation{eqn:basicStatMechProblemSet3Problem1:460}{
V_{2(n)+1} = \frac{2^{n+1} \pi^n R^{2 n + 1}}{(2n +1)!!}.
}

As with the even powered expression \eqnref{eqn:basicStatMechProblemSet3Problem1:400} we see that this is also good for \(n = 1\), yielding \(V_3 = 4 \pi R^2/3\) as required for the 3D spherical volume.

The even and odd power expressions don't look quite different on the surface, but can be put into a consistent form, when expressed in terms of the gamma function.

For the even powers, using a substitution \(2 n = m\) we have for even values of \(m \ge 2\)
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:480}
V_{m}
= \frac{\pi^{m/2} R^m}{\Gamma(n + 1)}
= \frac{\pi^{m/2} R^m}{\Gamma(m/2 + 1)}.
\end{equation}

For the even powers, with the help of \citep{abramowitz1964handbook} we find
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:500}
(2 n + 1)!! = \frac{2^{n+1} \Gamma\left(n + \frac{3}{2}\right)}{\sqrt{\pi}}.
\end{equation}

This gives us
\begin{dmath}\label{eqn:basicStatMechProblemSet3Problem1:520}
V_{2(n)+1}
= \frac{\pi^{n + 1/2} R^{2 n + 1}}{\Gamma\left(n + \frac{3}{2}\right)}
= \frac{\pi^{n + 1/2} R^{2 n + 1}}{\Gamma\left(\frac{(2 n + 1) + 2}{2}\right)}.
\end{dmath}

Writing \(m = 2 n + 1\), or \(n = (m - 1)/2\) we have for odd values of \(m \ge 3\) a match with the even powered expression of \eqnref{eqn:basicStatMechProblemSet3Problem1:480}

\boxedEquation{eqn:basicStatMechProblemSet3Problem1:540}{
V_{m}
=
\frac{ \pi^{m/2} R^{m} }
{
   \Gamma\left( m/2 + 1 \right)
}.
}

We've shown that this is valid for any dimension \(m \ge 2\).

Tabulating some values of these for \(n \in [2, 7]\) we have respectively
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:580}
\pi  r^2,\frac{4 \pi  r^3}{3},\frac{\pi ^2 r^4}{2},\frac{8 \pi ^2 r^5}{15},\frac{\pi ^3 r^6}{6},\frac{16 \pi ^3 r^7}{105},
\end{equation}

%matching the values from \href{http://en.wikipedia.org/wiki/File:N_SpheresVolumeAndSurfaceArea.png}{the wikipeda}
The only task left is computation of the surface area.  That comes by inspection and is
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:560}
S_{m}(R)
=\frac{d V_m(R)}{d R}
= \frac{\pi^{m/2} m R^{m-1}}{\Gamma\left( m/2 + 1 \right)}.
\end{equation}

Again for \(m \in [2, 7]\) we have
\begin{equation}\label{eqn:basicStatMechProblemSet3Problem1:600}
2 \pi  r,4 \pi  r^2,2 \pi ^2 r^3,\frac{8 \pi ^2 r^4}{3},\pi ^3 r^5,\frac{16 \pi ^3 r^6}{15}.
\end{equation}
}
