%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{phaseSpaceChangeOfVarsSpherical}
%\renewcommand{\dirname}{notes/phy452/}
%\newcommand{\keywords}{Statistical mechanics, PHY452H1S, phase space, Jacobian, change of variables, spherical coordinates}
%
%\input{../peeter_prologue_print2.tex}
%
%\beginArtNoToc
%
%\generatetitle{Cartesian to spherical change of variables in 3d phase space}
%\chapter{Cartesian to spherical change of variables in 3d phase space}
%\label{chap:phaseSpaceChangeOfVarsSpherical}

\makeoproblem{Cartesian to spherical change of variables in 3d phase space}{pr:phaseSpaceChangeOfVarsSpherical:1}{\citep{pathriastatistical} problem 2.2 (a)}{
Try a spherical change of vars to verify explicitly that phase space volume is preserved.
} % makeoproblem

\makeanswer{pr:phaseSpaceChangeOfVarsSpherical:1}{
Our kinetic Lagrangian in spherical coordinates is

\begin{dmath}\label{eqn:phaseSpaceChangeOfVarsSpherical:20}
\LL
= \inv{2} m \lr{ \rdot \rcap + r \sin\theta \phidot \phicap + r \thetadot \thetacap}^2
= \inv{2} m \lr{ \rdot^2 + r^2 \sin^2\theta \phidot^2 + r^2 \thetadot^2 }
\end{dmath}

We read off our canonical momentum

\begin{subequations}
\begin{equation}\label{eqn:phaseSpaceChangeOfVarsSpherical:40}
p_r = \PD{r}{\LL} = m \rdot
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVarsSpherical:60}
p_\theta = \PD{\theta}{\LL} = m r^2 \thetadot
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVarsSpherical:80}
p_\phi = \PD{\phi}{\LL} = m r^2 \sin^2\theta \phidot,
\end{equation}
\end{subequations}

and can now express the Hamiltonian in spherical coordinates

\begin{dmath}\label{eqn:phaseSpaceChangeOfVarsSpherical:100}
H = \inv{2} m \lr{
\lr{\frac{p_r}{m}}^2
+ r^2 \sin^2\theta \lr{\frac{p_\phi}{m r^2 \sin^2\theta}}
+ r^2 \lr{\frac{p_\theta}{m r^2}}
}
=
\frac{p_r^2}{2m} + \frac{p_\phi^2}{2 m r^2 \sin^2\theta} + \frac{p_\theta^2}{2 m r^2}
\end{dmath}

Now we want to do a change of variables.  The coordinates transform as

\begin{subequations}
\begin{equation}\label{eqn:phaseSpaceChangeOfVarsSpherical:120}
x = r \sin\theta \cos\phi
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVarsSpherical:140}
y = r \sin\theta \sin\phi
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVarsSpherical:160}
z = r \cos\theta,
\end{equation}
\end{subequations}

or
\begin{subequations}
\begin{equation}\label{eqn:phaseSpaceChangeOfVarsSpherical:180}
r = \sqrt{x^2 + y^2 + z^2}
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVarsSpherical:200}
\theta = \arccos(z/r)
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVarsSpherical:220}
\phi = \arctan(y/x).
\end{equation}
\end{subequations}

It's not too hard to calculate the change of variables for the momenta (verified in \nbref{sphericalPhaseSpaceChangeOfVars.nb}).  We have

\begin{subequations}
\begin{equation}\label{eqn:phaseSpaceChangeOfVarsSpherical:240}
p_r = \frac{
x p_x + y p_y + z p_z
}{\sqrt{x^2 + y^2 + z^2}}
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVarsSpherical:260}
p_\theta = \frac{
(p_x x + p_y y) z - p_z (x^2 + y^2)
}{\sqrt{x^2 + y^2}}
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVarsSpherical:280}
p_\phi = x p_y - y p_x
\end{equation}
\end{subequations}

Now let's compute the volume element in spherical coordinates.  With \(\rho^2 = x^2 + y^2\), this is

\begin{dmath}\label{eqn:phaseSpaceChangeOfVarsSpherical:300}
d\omega
= dr d\theta d\phi dp_r dp_\theta dp_\phi
=
\frac{\partial(r, \theta, \phi, p_r, p_\theta, p_\phi)}{\partial(x, y, z, p_x, p_y, p_z)}
dx dy dz dp_x dp_y dp_z
\end{dmath}

But
\begin{dmath}\label{eqn:phaseSpaceChangeOfVarsSpherical:300a}
\begin{aligned}
&\frac{\partial(r, \theta, \phi, p_r, p_\theta, p_\phi)}{\partial(x, y, z, p_x, p_y, p_z)} 
= \\
&\begin{vmatrix}
 \frac{x}{r} & \frac{y}{r} & \frac{z}{r} & 0 & 0 & 0 \\
 \frac{x z}{\rho r^2} & \frac{y z}{\rho r^2} & -\frac{\rho}{r^2} & 0 & 0 & 0 \\
 -\frac{y}{\rho^2} & \frac{x}{\rho^2} & 0 & 0 & 0 & 0 \\
 \frac{\left(y^2+z^2\right) p_x-x y p_y-x z p_z}{r^3} & \frac{\left(x^2+z^2\right) p_y-y \left(x p_x+z p_z\right)}{r^3} & \frac{\left(\rho^2\right) p_z-z \left(x p_x+y p_y\right)}{r^3} & \frac{x}{r} & \frac{y}{r} & \frac{z}{r} \\
 \frac{y z \left(y p_x-x p_y\right)-x \left(\rho^2\right) p_z}{\rho^3} & \frac{x z \left(x p_y-y p_x\right)-y \left(\rho^2\right) p_z}{\rho^3} & \frac{x p_x+y p_y}{\rho} & \frac{x z}{\rho} & \frac{y z}{\rho} & -\rho \\
 p_y & -p_x & 0 & -y & x & 0 \\
\end{vmatrix}
\end{aligned}
\end{dmath}

We find after a bit of computation that this determinant is also unity, as we found in the similar cylindrical change of phase space variables, so we have

\begin{dmath}\label{eqn:phaseSpaceChangeOfVarsSpherical:300b}
dr d\theta d\phi p_r p_\theta p_\phi = dx dy dz dp_x dp_y dp_z,
\end{dmath}

without the \(r^2 \sin\theta\) dependence that we have in the volume element for a change of variables from Cartesian to spherical coordinates in the spatial domain.

} % makeanswer

%\EndArticle
