%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{basicStatMechLecture14}
%\renewcommand{\dirname}{notes/phy452/}
%\newcommand{\keywords}{Statistical mechanics, PHY452H1S, canonical ensemble, grand canonical ensemble, partition function, entropy, grand partition function, chemical potential, trace, occupation numbers, equilibrium}
%\input{../peeter_prologue_print2.tex}
%
%\beginArtNoToc
%\generatetitle{PHY452H1S Basic Statistical Mechanics.  Lecture 14: Grand canonical ensemble.  Taught by Prof.\ Arun Paramekanti}
%\label{chap:basicStatMechLecture14}
%
%\section{Disclaimer}
%
%Peeter's lecture notes from class.  May not be entirely coherent.

This lecture had a large amount of spoken content not captured in these notes.  Reference to \S 4 \citep{pathriastatistical} was made for additional details.


%\cref{fig:lecture14:lecture14Fig1}.
\imageFigure{../figures/phy452-basicstatmech/lecture14Fig1}{Ensemble pictures.}{fig:lecture14:lecture14Fig1}{0.3}
%\cref{fig:lecture14:lecture14Fig2}.
%\imageFigure{../figures/phy452-basicstatmech/lecture14Fig2}{CAPTION}{fig:lecture14:lecture14Fig2}{0.3}
%F1
%F2

We are now going to allow particles to move to and from the system and the reservoir.  The total number of states in the system is
\begin{dmath}\label{eqn:basicStatMechLecture14:20}
\Omega_{\mathrm{total}} (N, V, E) =
\sum_{N_S, E_S}
\Omega_S(N_S, V_S, E_S)
\Omega_R(N - N_S, V_R, E - E_S),
\end{dmath}
so for \(N_S \ll N\), and \(E_S \ll E\), we have
\begin{dmath}\label{eqn:basicStatMechLecture14:40}
\Omega_R
= \exp\lr{ \inv{\kB} S_R(N- N_S, V_R, E - E_S)}
\approx
\exp\lr{
\inv{\kB} S_R(N, V_R, E)
-
\frac{N_S}{\kB} \PDc{N}{S_R}{V, E}
-
\frac{E_S}{\kB} \PDc{E}{S_R}{N, V}
}
\propto
\Omega_S(N_S, V_S, E_S)
e^{-\frac{\mu}{\kB T} N_S}
e^{-\frac{E_S}{\kB T} },
\end{dmath}
where the \textAndIndex{chemical potential} and \textAndIndex{temperature} are defined respectively as
\begin{subequations}
\begin{dmath}\label{eqn:basicStatMechLecture14:60}
\frac{\mu}{T} = -\PDc{N}{S_R}{V,E}
\end{dmath}
\begin{dmath}\label{eqn:basicStatMechLecture14:80}
\frac{1}{T} = \PDc{E}{S_R}{N,V}.
\end{dmath}
\end{subequations}

% FIXME: these labelled as reservoir property.

\begin{dmath}\label{eqn:basicStatMechLecture14:100}
\calP \propto
e^{\frac{\mu}{\kB T} N_S}
e^{-\frac{E_S}{\kB T} }.
\end{dmath}

With \(\{c\}\) as the set of all possible configuration pairs \(\{N_S, E_S\}\), we define the grand partition function
\begin{dmath}\label{eqn:basicStatMechLecture14:120}
\ZG = \sum_{\{c\}}
e^{\frac{\mu}{\kB T} N_S}
e^{-\frac{E_S}{\kB T} }.
\end{dmath}

So that the probability of finding a given state with energy and particle numbers \(\{E_S, N_S\}\) is
\begin{dmath}\label{eqn:basicStatMechLecture14:140}
\calP(E_S, N_S) =
\frac{
e^{\frac{\mu}{\kB T} N_S}
e^{-\frac{E_S}{\kB T} }
}{\ZG}.
\end{dmath}

For a classical system we have
\begin{dmath}\label{eqn:basicStatMechLecture14:160}
\{ c \} \rightarrow \{ x \} \{ p \},
\end{dmath}
whereas in a quantum content we have
\begin{dmath}\label{eqn:basicStatMechLecture14:180}
\{ c \} \rightarrow \text{eigenstate}.
\end{dmath}

\begin{dmath}\label{eqn:basicStatMechLecture14:200}
\ZG^{\mathrm{QM}} = {\tr}_{\{\text{energy}, N\}} \lr{
   e^{
      -\beta (\hat{H} - \mu \hat{N} )
   }
}.
\end{dmath}

We want to do this because the calculation of the number of states
\begin{dmath}\label{eqn:basicStatMechLecture14:220}
\int_{
\{ x \} \{ p \}
}
 \delta\lr{
\frac{p_1^2}{2m}
+
\frac{p_2^2}{2m}
+ \cdots
+ m g x_1
+ m g x_2
+ \cdots
},
\end{dmath}
can quickly become intractable.  We want to go to the canonical ensemble was because the partition function
\begin{dmath}\label{eqn:basicStatMechLecture14:260}
Z_c = \int_{
\{ x \} \{ p \}
}
e^{-\beta \lr{
\frac{p_1^2}{2m}
+
\frac{p_2^2}{2m}
+ \cdots
+ m g x_1
+ m g x_2
+ \cdots
}},
\end{dmath}

yields the same results, but can be much easier to compute.  We have a similar reason to go to the grand canonical ensemble, because this computation, once we allow the number of particles to vary also becomes very hard.

We are now going to define a notion of equilibrium so that it includes

\begin{itemize}
\item All forces are equal (mechanical equilibrium)
\item Temperatures are equal (no net heat flow)
\item Chemical potentials \index{chemical potential} are equal (no net particle flow)
\end{itemize}

We'll isolate a subsystem, containing a large number of particles \cref{fig:lecture14:lecture14Fig3}.

\imageFigure{../figures/phy452-basicstatmech/lecture14Fig3}{A subsystem to and from which particle motion is allowed.}{fig:lecture14:lecture14Fig3}{0.3}

When we think about Fermions we have to respect the ``Pauli exclusion'' principle \index{Pauli exclusion principle}.

Suppose we have just a one dimensional Fermion system for some potential as in \cref{fig:lecture14:lecture14Fig4}.

\imageFigure{../figures/phy452-basicstatmech/lecture14Fig4}{Energy level filling in a quantum system.}{fig:lecture14:lecture14Fig4}{0.3}

For every momentum \(k\) there are two possible occupation numbers \(n_k \in \{0, 1\}\)
our partition function is
\begin{dmath}\label{eqn:basicStatMechLecture14:240}
Z_c = \sum_{
n_k,
\sum_k n_k = N
} e^{-\beta \sum_k \epsilon_k n_k}.
\end{dmath}

We'd find that this calculation with this \(\sum_k n_k = N\) constraint becomes essentially impossible.

We'll see that relaxing this constraint will allow this calculation to become tractable.

%\EndArticle
