%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeoproblem{Maximum entropy principle}{basicStatMech:problemSet6:1}
{2013 ps6, p1}
{
%(3 points)
Consider the ``Gibbs entropy''
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:20}
S = - \kB \sum_i p_i \ln p_i,
\end{equation}
where \(p_i\) is the equilibrium probability of occurrence of a microstate \(i\) in the ensemble.
%
\makesubproblem{}{basicStatMech:problemSet6:1a}
For a microcanonical ensemble with \(\Omega\) configurations (each having the same energy), assigning an equal probability \(p_i= 1/\Omega\) to each microstate leads to \(S = \kB \ln \Omega\).  Show that this result follows from maximizing the Gibbs entropy with respect to the parameters \(p_i\) subject to the constraint of
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:40}
\sum_i p_i = 1,
\end{equation}
(for \(p_i\) to be meaningful as probabilities).  In order to do the minimization with this constraint, use the method of Lagrange multipliers - first, do an unconstrained minimization of the function
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:60}
S - \alpha \sum_i p_i,
\end{equation}
then fix \(\alpha\) by demanding that the constraint be satisfied.
%
\makesubproblem{}{basicStatMech:problemSet6:1b}
For a canonical ensemble (no constraint on total energy, but all microstates having the same number of particles \(N\)), maximize the Gibbs entropy with respect to the parameters \(p_i\) subject to the constraint of
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:200}
\sum_i p_i = 1,
\end{equation}
(for \(p_i\) to be meaningful as probabilities) and with a given fixed average energy
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:80}
\expectation{E} = \sum_i E_i p_i,
\end{equation}
where \(E_i\) is the energy of microstate \(i\).  Use the method of Lagrange multipliers, doing an unconstrained minimization of the function
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:100}
S - \alpha \sum_i p_i - \beta \sum_i E_i p_i,
\end{equation}
then fix \(\alpha, \beta\) by demanding that the constraint be satisfied.  What is the resulting \(p_i\)?
%
\makesubproblem{}{basicStatMech:problemSet6:1c}
For a grand canonical ensemble (no constraint on total energy, or the number of particles), maximize the Gibbs entropy with respect to the parameters \(p_i\) subject to the constraint of
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:120}
\sum_i p_i = 1,
\end{equation}
(for \(p_i\) to be meaningful as probabilities) and with a given fixed average energy
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:140}
\expectation{E} = \sum_i E_i p_i,
\end{equation}
and a given fixed average particle number
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:160}
\expectation{N} = \sum_i N_i p_i.
\end{equation}
%
Here \(E_i, N_i\) represent the energy and number of particles in microstate \(i\).  Use the method of Lagrange multipliers, doing an unconstrained minimization of the function
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:180}
S - \alpha \sum_i p_i - \beta \sum_i E_i p_i - \gamma \sum_i N_i p_i,
\end{equation}
%
then fix \(\alpha, \beta, \gamma\) by demanding that the constrains be satisfied.  What is the resulting \(p_i\)?
} % makeproblem
%
\makeanswer{basicStatMech:problemSet6:1}{
\makeSubAnswer{}{basicStatMech:problemSet6:1a}
%
Writing
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:220}
\begin{aligned}
f
&= S - \alpha \sum_{j = 1}^\Omega p_j \\
&= -\sum_{j = 1}^\Omega p_j \lr{ \kB \ln p_j + \alpha },
\end{aligned}
\end{equation}
our unconstrained minimization requires
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:240}
\begin{aligned}
0
&= \PD{p_i}{f} \\
&=
-\lr{
\kB \lr{ \ln p_i + 1 } + \alpha
}.
\end{aligned}
\end{equation}
%
Solving for \(p_i\) we have
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:260}
p_i = e^{-\alpha/\kB - 1}.
\end{equation}
%
The probabilities for each state are constant.  To fix that constant we employ our constraint
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:280}
\begin{aligned}
1
&= \sum_{j = 1}^\Omega p_j \\
&= \sum_{j = 1}^\Omega e^{-\alpha/\kB - 1} \\
&= \Omega e^{-\alpha/\kB - 1},
\end{aligned}
\end{equation}
or
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:300}
\alpha/\kB + 1 = \ln \Omega.
\end{equation}
%
Inserting \eqnref{eqn:basicStatMechProblemSet6Problem1:300} fixes the probability, giving us the first of the expected results
\boxedEquation{eqn:basicStatMechProblemSet6Problem1:320}{
p_i = e^{-\ln \Omega} = \inv{\Omega}.
}
%
Using this we our Gibbs entropy can be summed easily
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:340}
\begin{aligned}
S
&= -\kB \sum_{j = 1}^\Omega p_j \ln p_j \\
&= -\kB \sum_{j = 1}^\Omega \inv{\Omega} \ln \inv{\Omega} \\
&= -\kB \frac{\Omega}{\Omega} \lr{ -\ln \Omega },
\end{aligned}
\end{equation}
or
\boxedEquation{eqn:basicStatMechProblemSet6Problem1:360}{
S = \kB \ln \Omega.
}
%
\makeSubAnswer{}{basicStatMech:problemSet6:1b}
%
For the ``action'' like quantity that we want to minimize, let's write
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:380}
f = S - \alpha \sum_j p_j - \beta \sum_j E_j p_j,
\end{equation}
for which we seek \(\alpha\), \(\beta\) such that
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:400}
\begin{aligned}
0
&= \PD{p_i}{f} \\
&= -\PD{p_i}{}
\sum_j
p_j
\lr{
\kB \ln p_j + \alpha + \beta E_j
} \\
&=
-\kB (\ln p_i + 1) - \alpha - \beta E_i,
\end{aligned}
\end{equation}
or
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:420}
p_i 
=
\exp\lr{
- \lr{\alpha - \beta E_i}/\kB - 1
}.
\end{equation}
%
Our probability constraint is
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:440}
\begin{aligned}
1
&= \sum_j
\exp\lr{
- \lr{\alpha - \beta E_j}/\kB - 1
} \\
&=
\exp\lr{
- \alpha/\kB - 1
}
\sum_j
\exp\lr{
- \beta E_j/\kB
},
\end{aligned}
\end{equation}
or
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:460}
\exp\lr{
\alpha/\kB + 1
}
=
\sum_j
\exp\lr{
- \beta E_j/\kB
}.
\end{equation}
%
Taking logs we have
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:480}
\alpha/\kB + 1 =
\ln \sum_j
\exp\lr{
- \beta E_j/\kB
}.
\end{equation}
%
We could continue to solve for \(\alpha\) explicitly but don't care any more than this.  Plugging back into the probability \eqnref{eqn:basicStatMechProblemSet6Problem1:420} obtained from the unconstrained minimization we have
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:500}
p_i =
\exp\lr{
-\ln \sum_j
\exp\lr{
- \beta E_j/\kB
}
}
\exp\lr{
- \beta E_i/\kB
},
\end{equation}
or
\boxedEquation{eqn:basicStatMechProblemSet6Problem1:520}{
p_i =
\frac{
   \exp\lr{
      - \beta E_i/\kB
   }
}
{
   \sum_j
   \exp\lr{
      - \beta E_j/\kB
   }
}.
}
%
To determine \(\beta\) we must look implicitly to the energy constraint, which is
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:540}
\begin{aligned}
\expectation{E}
&= \sum_i E_i p_i \\
&=
\sum_i
E_i
\lr{
   \frac{
      \exp\lr{
         - \beta E_i/\kB
      }
   }
   {
      \sum_j
      \exp\lr{
         - \beta E_j/\kB
      }
   }
},
\end{aligned}
\end{equation}
%
or
\boxedEquation{eqn:basicStatMechProblemSet6Problem1:560}{
\expectation{E} =
\frac{
   \sum_i E_i \exp\lr{ - \beta E_i/\kB }
}
{
   \sum_j \exp\lr{ - \beta E_j/\kB }
}.
}
%
The constraint \(\beta\) (\(=1/T\)) is given implicitly by this energy constraint.
%
\makeSubAnswer{}{basicStatMech:problemSet6:1c}
%
Again write
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:580}
f = S - \alpha \sum_j p_j - \beta \sum_j E_j p_j - \gamma \sum_j N_j p_j.
\end{equation}
%
The unconstrained minimization requires
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:600}
\begin{aligned}
0
&= \PD{p_i}{f} \\
&= -\PD{p_i}{}
\lr{
\kB (\ln p_i + 1) + \alpha + \beta E_i + \gamma N_i
},
\end{aligned}
\end{equation}
or
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:620}
p_i
=
\exp\lr{ -\alpha/\kB - 1 }
\exp\lr{ -(\beta E_i + \gamma N_i)/\kB }.
\end{equation}
%
The unit probability constraint requires
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:640}
\begin{aligned}
1
&= \sum_j p_j \\
&=
\exp\lr{ -\alpha/\kB - 1 }
\sum_j
\exp\lr{ -(\beta E_j + \gamma N_j)/\kB },
\end{aligned}
\end{equation}
or
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:660}
\exp\lr{ -\alpha/\kB - 1 } =
\inv{
\sum_j
\exp\lr{ -(\beta E_j + \gamma N_j)/\kB }
}.
\end{equation}
%
Our probability is then
\boxedEquation{eqn:basicStatMechProblemSet6Problem1:680}{
p_i =
\frac{
\exp\lr{ -(\beta E_i + \gamma N_i)/\kB }
}{
\sum_j
\exp\lr{ -(\beta E_j + \gamma N_j)/\kB }
}.
}
%
The average energy \(\expectation{E} = \sum_j p_j E_j\) and average number of particles \(\expectation{N} = \sum_j p_j N_j\) are given by
\begin{subequations}
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:700}
\expectation{E} =
\frac{
E_i
\exp\lr{ -(\beta E_i + \gamma N_i)/\kB }
}{
\sum_j
\exp\lr{ -(\beta E_j + \gamma N_j)/\kB }
}
\end{equation}
\begin{equation}\label{eqn:basicStatMechProblemSet6Problem1:720}
\expectation{N} =
\frac{
N_i
\exp\lr{ -(\beta E_i + \gamma N_i)/\kB }
}{
\sum_j
\exp\lr{ -(\beta E_j + \gamma N_j)/\kB }
}.
\end{equation}
\end{subequations}
%
The values \(\beta\) and \(\gamma\) are fixed implicitly by requiring simultaneous solutions of these equations.
}
